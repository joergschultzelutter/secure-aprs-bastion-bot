# Installation instructions

The following installation instructions assume that the user is using the default names for the configuration files. If you want to use your own configuration file names, the following assumptions apply:

- The file `secure_aprs_bastion_bot.cfg` is the core configuration file for the actual APRS bot. Its name is also the only parameter that can be passed to the bot externally via a program argument if desired. All other bot-specific parameters are defined in this file.
- The name of the callsign/command-code configuration file (`sabb_command_config.yml`) is specified [in the bot's configuration file](/docs/secure-aprs-bastion-bot.md#configuration-file---excerpt). The callsign/command-code configuration file is newly created; therefore, there is no template provided
- The name of the [Apprise](https://www.github.com/caronc/apprise) crash messaging handler file is also specified in the core configuration file of the actual bot. A valid Apprise configuration should be stored here in order to receive a notification in the event of a program crash. Alternatively, the crash handler can also be disabled - see instructions.

## Initial steps
- Clone this repository
- `pip install -r requirements.txt` (or use the `requirements.txt` file from the respective project's subdirectories in case you just want to install a single program)

## Create the callsign/command-code configuration file with `configure.py`
- Configure the bot's callsign/command/code configuration file:
  - run [configure.py](docs/configure.md) and create at least one user account ([`--add-user`](/docs/configure-commands/add-user.md)), based on a call sign with or without SSID. This configuration can then be tested with the program's [`--test-totp-switch`](/docs/configure-commands/test-totp-code.md) command.
  - run [configure.py](docs/configure.md) again and add at least one `--command-code` / `--command-string` relationship entry ([`--add-command`](/docs/configure-commands/add-command.md)) to that user account.
  - Finally, use [configure.py](docs/configure.md) for local configuration file testing with the [`--execute-command-code`](/docs/configure-commands/execute-command-code.md) command. 
  - The callsign/command configuration file just generated by `configure.py` will be the foundation for `secure-aprs-bastion-bot`.

## Create the `secure-aprs-bastion-bot` configuration file
- Configure the bot's core configuration file. This file contains configuration info on the bot's callsign and other config info such as beaconing and broadcasting.
  - Rename the preconfigured configuration file [secure_aprs_bastion_bot.cfg.TEMPLATE](/src/secure-aprs-bastion-bot/secure_aprs_bastion_bot.cfg.TEMPLATE) and remove the `.TEMPLATE` file extension. `secure_aprs_bastion_bot.cfg` is the default configuration filename.
  - Amend the bot's [configuration file](/docs/secure-aprs-bastion-bot.md#configuration-file). The bot is based on my `core-aprs-client` framework ([repository link](https://github.com/joergschultzelutter/core-aprs-client)).
  - Set the [crash handler's config file name](https://github.com/joergschultzelutter/core-aprs-client/blob/master/docs/configuration_subsections/config_crash_handler.md) to `NOT_CONFIGURED` if you want to disable Apprise messaging. In any other case, configure the Apprise config file as shown in the next paragraph.

## Apprise config file 
- Configure the bot's Apprise messaging configuration file. If you want to disable the crash handler's Apprise messaging: see previous paragraph. 
  - rename the provided [`apprise.yml.TEMPLATE`](/src/secure-aprs-bastion-bot/apprise.yml.TEMPLATE) configuration file and remove the `.TEMPLATE` file extension. `apprise.yml` is the file's default filename.
  - Configure the file as illustrated in Apprise's [YAML Configuration Documentation](https://github.com/caronc/apprise/wiki/config_yaml)

## Starting the bot

- Start the bot and send your recently configured APRS commands (`--command-code`) to it.

```python
nohup python secure_aprs_bastion_bot.py >nohup.out &
```
